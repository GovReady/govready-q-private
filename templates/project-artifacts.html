{% extends "project-base.html" %}
{% load humanize %}
{% load guardian_tags %}
{% load static %}
{% load q %}

{% block title %}
  {{title}}
{% endblock %}

{% block head %}
{{block.super}}
<style>

  #focus-area-wrapper {
    padding: 2em 2em 3em 2em;
  }

  .question-column {
    padding: 0px 30px 0px 30px;
    padding: 10px;
    /*background-color: rgb(247,247,247);*/
    /*border-radius: 5px;*/
    max-width:66vw;
    /*box-shadow: 0 0 0 1px rgba(0, 0, 0, .1), 0 2px 3px rgba(0, 0, 0, .2);*/
  }

  .question-group {
    margin: 0px 0 20px 0;
    padding-top: 0px;
  }

  h2.question-column-title {
  }

  h3.question-group-title {
    color: black;
    text-align: center;
    font-weight: bold;
    padding: 0 18px 14px 0;
    margin: 0;
    width: 700px;
  }

  .question {
    background-color: #F6F7F7;
    border: 1px solid #C1C1C1;
    margin-bottom: 15px;
    padding-top: .5em;
    border-radius: 2px; /* good for highlighting */
    /*box-shadow: 0 0 0 1px rgba(0, 0, 0, .1), 0 2px 3px rgba(0, 0, 0, .2);*/
    /*border-left: 6px solid #999999;*/
  }

  .question-finished {
    border-left: 6px solid #88BB88;
  }

  /*.question:hover {
    background-color: #F6F7F7;
  }*/

  .question .question-icon {
    margin: 0 auto;
    width: 96px;
    height: 96px;
    padding:12px;
  }

  .question .question-title {
    margin-top: .5em;
    color: #222;
  }

  .question-title {
    text-align: left;
    margin: 0px 0px 0px 40px;
  }

  .question-title:hover span {display:none}
  .question-title:hover:before {content:"Click to edit this section...";
                                font-weight: bold;
                                font-style: italic;
  }

  .question-status {
    margin: 12px auto 20px auto;
    font-size: 0.8;
    color: #777;
  }

  .question .invitation {
    font-size: 14px;
    line-height: 128%;
  }

  .question .question-title {
    line-height: 124%;
  }

  .hr {  }
  .hr span {
      min-width: 130px;
      max-width: 300px;
      border-bottom: 1px solid #ccc;
      display: inline-block;
      margin: 5px;
  }

  #project-members {
    margin-top: 1em;
  }
  #project-members .role {
    font-style: italic;
    /*font-size: 85%;*/
  }
  #project-members .action {
    font-size: 85%;
  }

  /* New styles for project dashboard elements */
  .last-login { font-size:.8em;}
  li { padding-left: -10px; }
  .status { font-size:2em; color:#2D3337;}
  .status-welcome { font-size:2em; margin:0 0 1em 0; }
  .status-box { border:1px solid #C1C1C1; padding:5px; text-align:center; background: rgb(243,250,246);}
  .status-box-invisible {padding:5px; text-align:center;}
  .status-small { font-size: .8em;}

  .input-todo { padding-left:5px; }
  .alert-changed { font-size: 1.2em; margin:0; padding:1em 0 0 0}
  .status-section-header { display:block; border-bottom:1px solid #ccc; margin-bottom:1em; font-size:1.3em; }
  .piechart {
          display: block;
          margin:0 auto 0 auto;
          width: 66px;
          height: 66px;
          border-radius: 50%;
          background-image: conic-gradient(
              #E1F8E2  70deg,
              #B2E0B2 0 235deg);
      }
  .vuln-table { width:100%;}
  .vuln-table-head { font-size: .9em; }
  .vuln-table-component { font-size: 1.2em; font-weight:bold; padding:0; margin:0;}
  .vuln-table-component-desc { font-size: .8em; }
  .vuln-table-bad { color: red;}
  .vuln-table-medium { color: orange;}

  .portfolio-table { width:100%;}
  .portfolio-table-component { font-size: 1.2em; font-weight:bold; padding:0; margin:0;}
  .portfolio-table-component-desc { font-size: .8em; }

  body { height: 100vh; width: 100vw;}
</style>
{% endblock %}

<!-- action buttons included from project-base.html -->
<!-- authoring_tool_enabled included from project-base.html -->

{% block body_content %}

    <div class="row hidden" style="max-width: 1200px; text-align: center;">
      <h3 id="project-title" class="question-group-title hr" style="margin-left: 50px; font-size: 1.5em;">
        <span></span>
        &nbsp;&nbsp;
        {{ project.title }}
        &nbsp;&nbsp;
        <span></span>
      </h3>
      <p>&nbsp;</p>
    </div>

  <div class="col-md-12 hidden"><p>&nbsp;</p></div>
    <div class="row hidden">
        {% if project.root_task.module.spec.introduction %}
            {#<p class="project-text">#}
              {#{{project.root_task.render_introduction|safe}}#}
            {#</p>#}
        {% endif %}

        {% if project.root_task.module.spec.is_app_stub %}
          {# This project is tied to an app that has not yet been imported. #}
          <h2>Activate App</h2>
          <p>This app must be activated by an administrator of your organization. Send them <a href="javascript:invite_user_into_project()">an invitation</a> to join this project. When they get here, they&rsquo;ll be able to activate the app.</p>
        {% endif %}
    </div>

    <div class="row" style="max-width: 1200px;">
      <div class="col-md-12">
        <h2>Artifacts</h2>
        <div class="question-column">
            {% for group in question_groups.groups %}
            {% if group.title %}<div><a id="{{group.title}}"></a>&nbsp;</div>{% endif %}
            <div class="question-group">
              {% if group.title %}
              <h3 class="question-group-title hr">
                <span></span>
                &nbsp;
                {{group.title}}
                &nbsp;
                <span></span>
              </h3>
              {% endif %}
              <div class="row">
              {% for q in group.questions %}
                <div id="question-{{q.question.key}}"
                  {% if q.task  %}data-task-id="{{q.task.id}}"{% endif %}
                  class="col-xs-12"
                  style="width:760px;"
                >

                    {# The user may not have permission to actually start a Task, however. If not, show the same UI but without the form element that actually makes the request to start the Task. #}

                    <div class="question-title">
                      

                      <div class="question-status">
                        {% with task=q.task %}
                          
                            {% if q.module.spec.output|length > 0 %}
                              <p>
                                {# If task started we can link artifacts on task finished page, otherwise we can only know artifacts exist #}

                                This module prepares {{ q.module.spec.output|length }} artifact{{ q.module.spec.output|pluralize }}:

                                {% for artif in q.module.spec.output %}
                                  <br>
                                  {{ artif.title }} (once task started)
                                {% endfor %}
                              </p>
                            {% endif %}
                          
                        {% endwith %}
                      </div>
                    </div>

                    {# If the user had permission to start a task and we started an 'a' or 'form' element, end it. #}
                    {% if can_start_task %}
                      {% if not q.can_start_new_task %}
                        </a>
                      {% else %}
                        </form>
                      {% endif %}
                    {% endif %}

                    {% if q.task.is_started or q.task.is_finished %}
                    <p class="" style="margin-left: 40px; margin-bottom:12px;">
                      {% if q.module.spec.output|length > 0 %}
                        {# If task started we can link artifacts on task finished page, otherwise we can only know artifacts exist #}
                        {% if q.task %}
                          <a href="{{q.task.get_absolute_url}}/finished">This module has {{ q.module.spec.output|length }} artifact{{ q.module.spec.output|pluralize }} available</a>:
                        {% else %}
                        {% endif %}
                        {% for artif in q.module.spec.output %}
                          <br>
                          <a href="{{q.task.get_absolute_url}}/finished">{{ artif.title }}</a>
                          
                          {% endfor %}
                      {% endif %}
                    </p>
                    {% endif %}

                </div> <!-- /#question-__.question -->
              {% endfor %} {# question #}
              </div> <!-- /row -->
            </div>
            {% endfor %} {# group #}
        </div> <!-- end .question-column -->
      </div>
    </div>
{% endblock %}

{% block modals %}
{% include "controls/import_project_modal.html" %}
{% endblock %}

{% block scripts %}
    {{ block.super }}
<script>
var project_invitation_info = {{send_invitation|json}};




</script>
{% endblock %}